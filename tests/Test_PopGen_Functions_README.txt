The Test_PopGen_Functions.slim script runs a simulation for the purpose of testing the calcTajimaD(), calcPi, and calcWattersonsTheta() functions. It simulates neutral evolution (no selection) with a change in population size. While running, it computes the above 3 statistics continuously throughout the simulation (after a burn-in period). Mutation rate, subpopulation size, burn-in time and the change factor can be modified in-script. The first two parameters are described in, respectively, sections 4.1.2 and 5.1 in the SLiM manual. Sequence length and recombination rate (4.1.6) can technically be changed as well, as in any SLiM simulation, but they are not given as constants in this script as it shouldn't be necessary to alter them. Burn-in should be given in coalescent units. In diploids this is (2 * (subpopulation size)) ticks. The recommended burn-in to achieve mutation-drift balance is 20 units. This is based on section 17.10 of the SLiM manual which recommends 10*N where N is the number of diploid individuals, so it must be multiplied by 2 to give coalescent units for the haplotypes. Change factor gives the multiplication factor for population size change during the run. For example, a factor of 4  will increase population size 4x. A factor greater than 1 increases population size, equal to 1 has no effect, and less than 1 decreases population size. The default factor is 1/4. The default subpopulation size is 2000 and the default mutation rate 1e-6. These can be altered as desired but they presently give results that should exhibit the patterns described below with a relatively short run time. The simulation will create 3 plots (one for each statistic) at the end, with statistics plotted against ticks.

The plots can be used to examine multiple qualitative expectations of the statistics. Tajima's D should fluctuate around 0, as this is the standard neutral expectation (Tajima 1989 Genetics). Similarly, pi and Watterson's theta should fluctuate around 4 * (subpopulation size) * (mutation rate) (Kimura 1968 Genetics Research). The plots include ablines showing these expected values. Note that for the diversity statistics there will be two ablines because subpopulation size changes. This change temporarily sets the population out of equilibrium so a vertical line marks the change and the statistics should take some time to reset into equilibrium. In particular, Tajima's D should increase immediately after population shrinkage and decrease after population growth (Tajima 1989 Genetics). Additionally, pi is expected to have greater variance than Watterson's theta. This is true in the original derivations (Tajima 1983; Wattersons 1975) and holds in derivations with finite sequence length and recombination (Pluzhnikov and Donnelly 1996 Genetics), which are also parameters in the simulation. This difference in variance should be observable between the plots for pi and Watterson's theta.
